<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helpdesk Park - –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∞–º–∏</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .telegram-theme {
            background-color: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
        }
        .telegram-button {
            background-color: var(--tg-theme-button-color, #2481cc);
            color: var(--tg-theme-button-text-color, #ffffff);
        }
        .telegram-secondary {
            background-color: var(--tg-theme-secondary-bg-color, #f1f1f1);
        }
        .status-new { @apply bg-blue-100 text-blue-800 border-blue-200; }
        .status-in-progress { @apply bg-yellow-100 text-yellow-800 border-yellow-200; }
        .status-resolved { @apply bg-green-100 text-green-800 border-green-200; }
        .status-closed { @apply bg-gray-100 text-gray-800 border-gray-200; }
        .priority-low { @apply bg-green-100 text-green-800 border-green-200; }
        .priority-medium { @apply bg-yellow-100 text-yellow-800 border-yellow-200; }
        .priority-high { @apply bg-red-100 text-red-800 border-red-200; }
        .priority-critical { @apply bg-purple-100 text-purple-800 border-purple-200; }
    </style>
</head>
<body class="telegram-theme min-h-screen">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 shadow-lg">
        <div class="flex items-center justify-between">
            <h1 class="text-xl font-bold">üè¢ Helpdesk Park</h1>
            <div class="flex items-center space-x-2">
                <span id="userInfo" class="text-sm">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-md p-2">
        <div class="flex space-x-2 overflow-x-auto">
            <button onclick="showPage('dashboard')" class="nav-btn px-4 py-2 rounded-lg bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors">
                üìä –î–∞—à–±–æ—Ä–¥
            </button>
            <button onclick="showPage('tickets')" class="nav-btn px-4 py-2 rounded-lg bg-gray-100 text-gray-800 hover:bg-gray-200 transition-colors">
                üìã –ó–∞—è–≤–∫–∏
            </button>
            <button onclick="showPage('create')" class="nav-btn px-4 py-2 rounded-lg bg-green-100 text-green-800 hover:bg-green-200 transition-colors">
                ‚ûï –°–æ–∑–¥–∞—Ç—å
            </button>
            <button onclick="showPage('assignees')" class="nav-btn px-4 py-2 rounded-lg bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors">
                üë• –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ
            </button>
            <button onclick="showPage('stats')" class="nav-btn px-4 py-2 rounded-lg bg-orange-100 text-orange-800 hover:bg-orange-200 transition-colors">
                üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            </button>
            <button onclick="showPage('profile')" class="nav-btn px-4 py-2 rounded-lg bg-indigo-100 text-indigo-800 hover:bg-indigo-200 transition-colors">
                üë§ –ü—Ä–æ—Ñ–∏–ª—å
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="p-4 max-w-6xl mx-auto">
        <!-- Dashboard Page -->
        <div id="dashboard" class="page">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div class="bg-white p-4 rounded-lg shadow-md border-l-4 border-blue-500">
                    <h3 class="text-lg font-semibold text-gray-700">–ù–æ–≤—ã–µ</h3>
                    <p class="text-3xl font-bold text-blue-600" id="newTickets">0</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md border-l-4 border-yellow-500">
                    <h3 class="text-lg font-semibold text-gray-700">–í —Ä–∞–±–æ—Ç–µ</h3>
                    <p class="text-3xl font-bold text-yellow-600" id="inProgressTickets">0</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md border-l-4 border-green-500">
                    <h3 class="text-lg font-semibold text-gray-700">–†–µ—à–µ–Ω–æ</h3>
                    <p class="text-3xl font-bold text-green-600" id="resolvedTickets">0</p>
                </div>
                <div class="bg-white p-4 rounded-lg shadow-md border-l-4 border-gray-500">
                    <h3 class="text-lg font-semibold text-gray-700">–í—Å–µ–≥–æ</h3>
                    <p class="text-3xl font-bold text-gray-600" id="totalTickets">0</p>
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold mb-4">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞—è–≤–∫–∏</h3>
                    <div id="recentTickets" class="space-y-3">
                        <!-- Recent tickets will be loaded here -->
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold mb-4">–ú–æ–∏ –∑–∞—è–≤–∫–∏</h3>
                    <div id="myTickets" class="space-y-3">
                        <!-- My tickets will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Tickets Page -->
        <div id="tickets" class="page hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">üìã –í—Å–µ –∑–∞—è–≤–∫–∏</h2>
                <div class="flex space-x-2">
                    <select id="statusFilter" class="px-3 py-2 border rounded-lg" onchange="filterTickets()">
                        <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                        <option value="new">–ù–æ–≤—ã–µ</option>
                        <option value="in-progress">–í —Ä–∞–±–æ—Ç–µ</option>
                        <option value="resolved">–†–µ—à–µ–Ω–æ</option>
                        <option value="closed">–ó–∞–∫—Ä—ã—Ç–æ</option>
                    </select>
                    <select id="priorityFilter" class="px-3 py-2 border rounded-lg" onchange="filterTickets()">
                        <option value="">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
                        <option value="low">–ù–∏–∑–∫–∏–π</option>
                        <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                        <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                        <option value="critical">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π</option>
                    </select>
                    <select id="assigneeFilter" class="px-3 py-2 border rounded-lg" onchange="filterTickets()">
                        <option value="">–í—Å–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–µ</option>
                        <!-- Assignees will be loaded here -->
                    </select>
                </div>
            </div>
            
            <div id="ticketsList" class="space-y-4">
                <!-- Tickets will be loaded here -->
            </div>
        </div>

        <!-- Create Ticket Page -->
        <div id="create" class="page hidden">
            <div class="max-w-2xl mx-auto">
                <h2 class="text-2xl font-bold mb-6">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É</h2>
                
                <form id="createTicketForm" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞—è–≤–∫–∏ *</label>
                        <input type="text" id="ticketTitle" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–û–ø–∏—Å–∞–Ω–∏–µ *</label>
                        <textarea id="ticketDescription" rows="4" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç *</label>
                            <select id="ticketPriority" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
                                <option value="low">–ù–∏–∑–∫–∏–π</option>
                                <option value="medium">–°—Ä–µ–¥–Ω–∏–π</option>
                                <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                                <option value="critical">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                            <select id="ticketCategory" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</option>
                                <option value="technical">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</option>
                                <option value="billing">–ë–∏–ª–ª–∏–Ω–≥</option>
                                <option value="feature">–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª</option>
                                <option value="bug">–û—à–∏–±–∫–∞</option>
                                <option value="other">–î—Ä—É–≥–æ–µ</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</label>
                        <select id="ticketAssignee" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</option>
                            <!-- Assignees will be loaded here -->
                        </select>
                    </div>
                    
                    <div class="flex space-x-4">
                        <button type="submit" class="flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                            üìù –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
                        </button>
                        <button type="button" onclick="showPage('tickets')" class="px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Assignees Management Page -->
        <div id="assignees" class="page hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º–∏</h2>
                <button onclick="showAddAssigneeModal()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                    ‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ
                </button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="assigneesList">
                <!-- Assignees will be loaded here -->
            </div>
        </div>

        <!-- Stats Page -->
        <div id="stats" class="page hidden">
            <h2 class="text-2xl font-bold mb-6">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold mb-4">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</h3>
                    <canvas id="statusChart" width="400" height="200"></canvas>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold mb-4">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º</h3>
                    <canvas id="priorityChart" width="400" height="200"></canvas>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow-md mt-6">
                <h3 class="text-lg font-semibold mb-4">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö</h3>
                <div id="assigneeStats" class="space-y-3">
                    <!-- Assignee stats will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Profile Page -->
        <div id="profile" class="page hidden">
            <div class="max-w-2xl mx-auto">
                <h2 class="text-2xl font-bold mb-6">üë§ –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
                
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="text-2xl font-bold text-blue-600" id="profileInitials">U</span>
                        </div>
                        <div>
                            <h3 class="text-xl font-semibold" id="profileName">–ó–∞–≥—Ä—É–∑–∫–∞...</h3>
                            <p class="text-gray-600" id="profileUsername">@username</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–†–æ–ª—å</label>
                            <p class="text-gray-900" id="profileRole">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <p class="text-gray-900" id="profileEmail">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–û—Ç–¥–µ–ª</label>
                            <p class="text-gray-900" id="profileDepartment">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</label>
                            <p class="text-gray-900" id="profileRegistration">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-lg shadow-md mt-6">
                    <h3 class="text-lg font-semibold mb-4">–ú–æ–∏ –∑–∞—è–≤–∫–∏</h3>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                        <div>
                            <p class="text-2xl font-bold text-blue-600" id="myNewTickets">0</p>
                            <p class="text-sm text-gray-600">–ù–æ–≤—ã–µ</p>
                        </div>
                        <div>
                            <p class="text-2xl font-bold text-yellow-600" id="myInProgressTickets">0</p>
                            <p class="text-sm text-gray-600">–í —Ä–∞–±–æ—Ç–µ</p>
                        </div>
                        <div>
                            <p class="text-2xl font-bold text-green-600" id="myResolvedTickets">0</p>
                            <p class="text-sm text-gray-600">–†–µ—à–µ–Ω–æ</p>
                        </div>
                        <div>
                            <p class="text-2xl font-bold text-gray-600" id="myTotalTickets">0</p>
                            <p class="text-sm text-gray-600">–í—Å–µ–≥–æ</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Add Assignee Modal -->
    <div id="addAssigneeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6">
                <h3 class="text-lg font-semibold mb-4">‚ûï –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ</h3>
                
                <form id="addAssigneeForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–ò–º—è *</label>
                        <input type="text" id="assigneeName" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Email *</label>
                        <input type="email" id="assigneeEmail" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–û—Ç–¥–µ–ª</label>
                        <input type="text" id="assigneeDepartment" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">–†–æ–ª—å</label>
                        <select id="assigneeRole" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="support">–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞</option>
                            <option value="developer">–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫</option>
                            <option value="manager">–ú–µ–Ω–µ–¥–∂–µ—Ä</option>
                            <option value="admin">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                        </select>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button type="submit" class="flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                            –î–æ–±–∞–≤–∏—Ç—å
                        </button>
                        <button type="button" onclick="hideAddAssigneeModal()" class="flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Ticket Detail Modal -->
    <div id="ticketDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-screen overflow-y-auto">
                <div class="p-6">
                    <div class="flex justify-between items-start mb-4">
                        <h3 class="text-lg font-semibold" id="modalTicketTitle">–ó–∞–≥–æ–ª–æ–≤–æ–∫ –∑–∞—è–≤–∫–∏</h3>
                        <button onclick="hideTicketDetailModal()" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <div id="modalTicketContent">
                        <!-- Ticket content will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mock data for demonstration
        let tickets = [
            {
                id: 1,
                title: "–ü—Ä–æ–±–ª–µ–º–∞ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ —Å–∏—Å—Ç–µ–º–µ",
                description: "–ù–µ –º–æ–≥—É –≤–æ–π—Ç–∏ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç, –≤—ã–¥–∞–µ—Ç –æ—à–∏–±–∫—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏",
                status: "new",
                priority: "high",
                category: "technical",
                assignee: null,
                createdBy: "user1",
                createdAt: "2024-01-15T10:30:00Z",
                updatedAt: "2024-01-15T10:30:00Z"
            },
            {
                id: 2,
                title: "–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –æ—Ç—á–µ—Ç",
                description: "–ù—É–∂–µ–Ω –æ—Ç—á–µ—Ç –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–≤–∞—Ä—Ç–∞–ª",
                status: "in-progress",
                priority: "medium",
                category: "feature",
                assignee: "assignee1",
                createdBy: "user2",
                createdAt: "2024-01-14T14:20:00Z",
                updatedAt: "2024-01-15T09:15:00Z"
            },
            {
                id: 3,
                title: "–û—à–∏–±–∫–∞ –≤ —Ä–∞—Å—á–µ—Ç–µ —Å–∫–∏–¥–æ–∫",
                description: "–°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∫–∏–¥–∫–∏ –¥–ª—è VIP –∫–ª–∏–µ–Ω—Ç–æ–≤",
                status: "resolved",
                priority: "critical",
                category: "bug",
                assignee: "assignee2",
                createdBy: "user3",
                createdAt: "2024-01-13T16:45:00Z",
                updatedAt: "2024-01-15T11:30:00Z"
            }
        ];

        let assignees = [
            {
                id: "assignee1",
                name: "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
                email: "ivan.petrov@company.com",
                department: "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞",
                role: "developer",
                avatar: "IP"
            },
            {
                id: "assignee2",
                name: "–ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞",
                email: "maria.sidorova@company.com",
                department: "–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞",
                role: "support",
                avatar: "–ú–°"
            },
            {
                id: "assignee3",
                name: "–ê–ª–µ–∫—Å–µ–π –ö–æ–∑–ª–æ–≤",
                email: "alexey.kozlov@company.com",
                department: "–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç",
                role: "manager",
                avatar: "–ê–ö"
            }
        ];

        let currentUser = {
            id: "user1",
            name: "–í–ª–∞–¥–∏–º–∏—Ä –ö—É–∑–∏–Ω",
            username: "KuzinVA",
            role: "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",
            email: "vladimir.kuzin@company.com",
            department: "IT –æ—Ç–¥–µ–ª",
            registrationDate: "2024-01-01"
        };

        // Initialize Telegram WebApp
        function initTelegram() {
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
                window.Telegram.WebApp.expand();
                
                // Set theme colors
                const theme = window.Telegram.WebApp.colorScheme;
                if (theme === 'dark') {
                    document.body.classList.add('dark');
                }
                
                // Get user info if available
                if (window.Telegram.WebApp.initDataUnsafe && window.Telegram.WebApp.initDataUnsafe.user) {
                    const tgUser = window.Telegram.WebApp.initDataUnsafe.user;
                    currentUser.name = `${tgUser.first_name} ${tgUser.last_name || ''}`.trim();
                    currentUser.username = tgUser.username || currentUser.username;
                }
            }
            
            updateUserInfo();
            loadDashboard();
            loadAssignees();
        }

        // Navigation
        function showPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            
            // Show selected page
            document.getElementById(pageName).classList.remove('hidden');
            
            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('bg-blue-600', 'text-white');
                btn.classList.add('bg-gray-100', 'text-gray-800');
            });
            
            // Highlight current page button
            event.target.classList.remove('bg-gray-100', 'text-gray-800');
            event.target.classList.add('bg-blue-600', 'text-white');
            
            // Load page-specific content
            switch(pageName) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'tickets':
                    loadTickets();
                    break;
                case 'assignees':
                    loadAssignees();
                    break;
                case 'stats':
                    loadStats();
                    break;
                case 'profile':
                    loadProfile();
                    break;
            }
        }

        // Dashboard functions
        function loadDashboard() {
            updateDashboardStats();
            loadRecentTickets();
            loadMyTickets();
        }

        function updateDashboardStats() {
            const newCount = tickets.filter(t => t.status === 'new').length;
            const inProgressCount = tickets.filter(t => t.status === 'in-progress').length;
            const resolvedCount = tickets.filter(t => t.status === 'resolved').length;
            const totalCount = tickets.length;
            
            document.getElementById('newTickets').textContent = newCount;
            document.getElementById('inProgressTickets').textContent = inProgressCount;
            document.getElementById('resolvedTickets').textContent = resolvedCount;
            document.getElementById('totalTickets').textContent = totalCount;
        }

        function loadRecentTickets() {
            const recentTickets = tickets.slice(0, 5);
            const container = document.getElementById('recentTickets');
            
            container.innerHTML = recentTickets.map(ticket => `
                <div class="border-l-4 border-blue-500 pl-3 py-2">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="font-medium text-gray-900">${ticket.title}</h4>
                            <p class="text-sm text-gray-600">${ticket.description.substring(0, 60)}...</p>
                        </div>
                        <div class="flex flex-col items-end space-y-1">
                            <span class="status-${ticket.status} px-2 py-1 text-xs rounded-full border">
                                ${getStatusText(ticket.status)}
                            </span>
                            <span class="priority-${ticket.priority} px-2 py-1 text-xs rounded-full border">
                                ${getPriorityText(ticket.priority)}
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function loadMyTickets() {
            const myTickets = tickets.filter(t => t.createdBy === currentUser.id).slice(0, 5);
            const container = document.getElementById('myTickets');
            
            container.innerHTML = myTickets.map(ticket => `
                <div class="border-l-4 border-green-500 pl-3 py-2">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="font-medium text-gray-900">${ticket.title}</h4>
                            <p class="text-sm text-gray-600">${ticket.description.substring(0, 60)}...</p>
                        </div>
                        <div class="flex flex-col items-end space-y-1">
                            <span class="status-${ticket.status} px-2 py-1 text-xs rounded-full border">
                                ${getStatusText(ticket.status)}
                            </span>
                            <span class="priority-${ticket.priority} px-2 py-1 text-xs rounded-full border">
                                ${getPriorityText(ticket.priority)}
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Tickets functions
        function loadTickets() {
            const container = document.getElementById('ticketsList');
            const filteredTickets = filterTickets();
            
            container.innerHTML = filteredTickets.map(ticket => `
                <div class="bg-white p-4 rounded-lg shadow-md border-l-4 border-blue-500 hover:shadow-lg transition-shadow cursor-pointer" onclick="showTicketDetail(${ticket.id})">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">${ticket.title}</h3>
                            <p class="text-gray-600 mb-3">${ticket.description.substring(0, 100)}...</p>
                            <div class="flex items-center space-x-4 text-sm text-gray-500">
                                <span>üìÖ ${formatDate(ticket.createdAt)}</span>
                                <span>üë§ ${ticket.createdBy}</span>
                                <span>üè∑Ô∏è ${getCategoryText(ticket.category)}</span>
                            </div>
                        </div>
                        <div class="flex flex-col items-end space-y-2">
                            <span class="status-${ticket.status} px-3 py-1 text-sm rounded-full border">
                                ${getStatusText(ticket.status)}
                            </span>
                            <span class="priority-${ticket.priority} px-3 py-1 text-sm rounded-full border">
                                ${getPriorityText(ticket.priority)}
                            </span>
                            ${ticket.assignee ? `
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm text-gray-600">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π:</span>
                                    <span class="text-sm font-medium">${getAssigneeName(ticket.assignee)}</span>
                                </div>
                            ` : '<span class="text-sm text-gray-400">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</span>'}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterTickets() {
            const statusFilter = document.getElementById('statusFilter').value;
            const priorityFilter = document.getElementById('priorityFilter').value;
            const assigneeFilter = document.getElementById('assigneeFilter').value;
            
            return tickets.filter(ticket => {
                const statusMatch = !statusFilter || ticket.status === statusFilter;
                const priorityMatch = !priorityFilter || ticket.priority === priorityFilter;
                const assigneeMatch = !assigneeFilter || ticket.assignee === assigneeFilter;
                
                return statusMatch && priorityMatch && assigneeMatch;
            });
        }

        // Create ticket functions
        function createTicket(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const ticket = {
                id: tickets.length + 1,
                title: document.getElementById('ticketTitle').value,
                description: document.getElementById('ticketDescription').value,
                priority: document.getElementById('ticketPriority').value,
                category: document.getElementById('ticketCategory').value,
                assignee: document.getElementById('ticketAssignee').value || null,
                status: 'new',
                createdBy: currentUser.id,
                createdAt: new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };
            
            tickets.push(ticket);
            
            // Reset form
            event.target.reset();
            
            // Show success message
            showAlert('‚úÖ –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞!');
            
            // Go to tickets page
            showPage('tickets');
        }

        // Assignees functions
        function loadAssignees() {
            // Update assignee filters
            updateAssigneeFilters();
            
            // Update assignees list
            const container = document.getElementById('assigneesList');
            container.innerHTML = assignees.map(assignee => `
                <div class="bg-white p-4 rounded-lg shadow-md">
                    <div class="flex items-center space-x-3 mb-3">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                            <span class="text-lg font-bold text-blue-600">${assignee.avatar}</span>
                        </div>
                        <div class="flex-1">
                            <h3 class="font-semibold text-gray-900">${assignee.name}</h3>
                            <p class="text-sm text-gray-600">${assignee.email}</p>
                        </div>
                    </div>
                    <div class="space-y-2 text-sm">
                        <p><span class="font-medium">–û—Ç–¥–µ–ª:</span> ${assignee.department}</p>
                        <p><span class="font-medium">–†–æ–ª—å:</span> ${getRoleText(assignee.role)}</p>
                        <p><span class="font-medium">–ó–∞—è–≤–æ–∫ –≤ —Ä–∞–±–æ—Ç–µ:</span> ${getAssigneeTicketCount(assignee.id)}</p>
                    </div>
                    <div class="flex space-x-2 mt-3">
                        <button onclick="editAssignee('${assignee.id}')" class="flex-1 bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700 transition-colors">
                            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                        </button>
                        <button onclick="deleteAssignee('${assignee.id}')" class="flex-1 bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700 transition-colors">
                            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function updateAssigneeFilters() {
            const assigneeSelects = ['assigneeFilter', 'ticketAssignee'];
            
            assigneeSelects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    const currentValue = select.value;
                    select.innerHTML = '<option value="">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</option>';
                    
                    assignees.forEach(assignee => {
                        const option = document.createElement('option');
                        option.value = assignee.id;
                        option.textContent = assignee.name;
                        select.appendChild(option);
                    });
                    
                    select.value = currentValue;
                }
            });
        }

        function addAssignee(event) {
            event.preventDefault();
            
            const assignee = {
                id: 'assignee' + (assignees.length + 1),
                name: document.getElementById('assigneeName').value,
                email: document.getElementById('assigneeEmail').value,
                department: document.getElementById('assigneeDepartment').value,
                role: document.getElementById('assigneeRole').value,
                avatar: document.getElementById('assigneeName').value.split(' ').map(n => n[0]).join('').toUpperCase()
            };
            
            assignees.push(assignee);
            
            // Reset form
            event.target.reset();
            
            // Hide modal
            hideAddAssigneeModal();
            
            // Reload assignees
            loadAssignees();
            
            // Show success message
            showAlert('‚úÖ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!');
        }

        // Modal functions
        function showAddAssigneeModal() {
            document.getElementById('addAssigneeModal').classList.remove('hidden');
        }

        function hideAddAssigneeModal() {
            document.getElementById('addAssigneeModal').classList.add('hidden');
        }

        function showTicketDetail(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            document.getElementById('modalTicketTitle').textContent = ticket.title;
            
            const content = document.getElementById('modalTicketContent');
            content.innerHTML = `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <p class="text-gray-900">${ticket.description}</p>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–°—Ç–∞—Ç—É—Å</label>
                            <span class="status-${ticket.status} px-3 py-1 text-sm rounded-full border">
                                ${getStatusText(ticket.status)}
                            </span>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                            <span class="priority-${ticket.priority} px-3 py-1 text-sm rounded-full border">
                                ${getPriorityText(ticket.priority)}
                            </span>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                            <p class="text-gray-900">${getCategoryText(ticket.category)}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</label>
                            <p class="text-gray-900">${ticket.assignee ? getAssigneeName(ticket.assignee) : '–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω'}</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–°–æ–∑–¥–∞–Ω–æ</label>
                            <p class="text-gray-900">${formatDate(ticket.createdAt)}</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">–û–±–Ω–æ–≤–ª–µ–Ω–æ</label>
                            <p class="text-gray-900">${formatDate(ticket.updatedAt)}</p>
                        </div>
                    </div>
                    
                    <div class="border-t pt-4">
                        <h4 class="font-medium text-gray-900 mb-2">–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å</h4>
                        <div class="flex space-x-2">
                            <select id="newStatus" class="px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="new">–ù–æ–≤—ã–π</option>
                                <option value="in-progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                <option value="resolved">–†–µ—à–µ–Ω–æ</option>
                                <option value="closed">–ó–∞–∫—Ä—ã—Ç–æ</option>
                            </select>
                            <button onclick="updateTicketStatus(${ticket.id})" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                                –û–±–Ω–æ–≤–∏—Ç—å
                            </button>
                        </div>
                    </div>
                    
                    <div class="border-t pt-4">
                        <h4 class="font-medium text-gray-900 mb-2">–ù–∞–∑–Ω–∞—á–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ</h4>
                        <div class="flex space-x-2">
                            <select id="newAssignee" class="px-3 py-2 border border-gray-300 rounded-lg">
                                <option value="">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</option>
                                ${assignees.map(a => `<option value="${a.id}">${a.name}</option>`).join('')}
                            </select>
                            <button onclick="updateTicketAssignee(${ticket.id})" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                                –ù–∞–∑–Ω–∞—á–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // Set current values
            document.getElementById('newStatus').value = ticket.status;
            document.getElementById('newAssignee').value = ticket.assignee || '';
            
            document.getElementById('ticketDetailModal').classList.remove('hidden');
        }

        function hideTicketDetailModal() {
            document.getElementById('ticketDetailModal').classList.add('hidden');
        }

        // Utility functions
        function getStatusText(status) {
            const statusMap = {
                'new': '–ù–æ–≤—ã–π',
                'in-progress': '–í —Ä–∞–±–æ—Ç–µ',
                'resolved': '–†–µ—à–µ–Ω–æ',
                'closed': '–ó–∞–∫—Ä—ã—Ç–æ'
            };
            return statusMap[status] || status;
        }

        function getPriorityText(priority) {
            const priorityMap = {
                'low': '–ù–∏–∑–∫–∏–π',
                'medium': '–°—Ä–µ–¥–Ω–∏–π',
                'high': '–í—ã—Å–æ–∫–∏–π',
                'critical': '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π'
            };
            return priorityMap[priority] || priority;
        }

        function getCategoryText(category) {
            const categoryMap = {
                'technical': '–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞',
                'billing': '–ë–∏–ª–ª–∏–Ω–≥',
                'feature': '–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª',
                'bug': '–û—à–∏–±–∫–∞',
                'other': '–î—Ä—É–≥–æ–µ'
            };
            return categoryMap[category] || category;
        }

        function getRoleText(role) {
            const roleMap = {
                'support': '–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞',
                'developer': '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫',
                'manager': '–ú–µ–Ω–µ–¥–∂–µ—Ä',
                'admin': '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'
            };
            return roleMap[role] || role;
        }

        function getAssigneeName(assigneeId) {
            const assignee = assignees.find(a => a.id === assigneeId);
            return assignee ? assignee.name : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
        }

        function getAssigneeTicketCount(assigneeId) {
            return tickets.filter(t => t.assignee === assigneeId && t.status !== 'closed').length;
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('ru-RU', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function updateUserInfo() {
            document.getElementById('userInfo').textContent = currentUser.name;
            document.getElementById('profileName').textContent = currentUser.name;
            document.getElementById('profileUsername').textContent = `@${currentUser.username}`;
            document.getElementById('profileRole').textContent = currentUser.role;
            document.getElementById('profileEmail').textContent = currentUser.email;
            document.getElementById('profileDepartment').textContent = currentUser.department;
            document.getElementById('profileRegistration').textContent = currentUser.registrationDate;
            document.getElementById('profileInitials').textContent = currentUser.name.split(' ').map(n => n[0]).join('').toUpperCase();
        }

        function updateTicketStatus(ticketId) {
            const newStatus = document.getElementById('newStatus').value;
            const ticket = tickets.find(t => t.id === ticketId);
            
            if (ticket) {
                ticket.status = newStatus;
                ticket.updatedAt = new Date().toISOString();
                
                showAlert('‚úÖ –°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω!');
                hideTicketDetailModal();
                loadDashboard();
                loadTickets();
            }
        }

        function updateTicketAssignee(ticketId) {
            const newAssignee = document.getElementById('newAssignee').value;
            const ticket = tickets.find(t => t.id === ticketId);
            
            if (ticket) {
                ticket.assignee = newAssignee || null;
                ticket.updatedAt = new Date().toISOString();
                
                showAlert('‚úÖ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–∑–Ω–∞—á–µ–Ω!');
                hideTicketDetailModal();
                loadDashboard();
                loadTickets();
            }
        }

        function showAlert(message) {
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.showAlert(message);
            } else {
                alert(message);
            }
        }

        // Event listeners
        document.getElementById('createTicketForm').addEventListener('submit', createTicket);
        document.getElementById('addAssigneeForm').addEventListener('submit', addAssignee);

        // Initialize app
        document.addEventListener('DOMContentLoaded', initTelegram);
    </script>
</body>
</html>
