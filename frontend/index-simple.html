<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helpdesk Park App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .btn { @apply px-4 py-2 rounded-lg font-medium transition-colors duration-200; }
        .btn-primary { @apply btn bg-blue-600 text-white hover:bg-blue-700; }
        .btn-secondary { @apply btn bg-gray-200 text-gray-800 hover:bg-gray-300; }
        .card { @apply bg-white rounded-lg shadow-sm border border-gray-200 p-6; }
        .badge { @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium; }
        .badge-new { @apply badge bg-blue-100 text-blue-800; }
        .badge-assigned { @apply badge bg-yellow-100 text-yellow-800; }
        .badge-progress { @apply badge bg-purple-100 text-purple-800; }
        .badge-resolved { @apply badge bg-green-100 text-green-800; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="min-h-screen">
        <!-- Loading -->
        <div id="loading" class="flex items-center justify-center min-h-screen">
            <div class="text-center">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"></div>
                <p class="text-gray-600">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
            </div>
        </div>

        <!-- Main App -->
        <div id="main" class="hidden">
            <!-- Header -->
            <header class="bg-white shadow-sm border-b border-gray-200">
                <div class="max-w-7xl mx-auto px-4 py-4">
                    <div class="flex justify-between items-center">
                        <h1 class="text-xl font-semibold text-gray-900">Helpdesk Park</h1>
                        <div class="flex items-center space-x-4">
                            <button id="notifications" class="p-2 text-gray-400 hover:text-gray-500">
                                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M9 11h.01M9 8h.01"></path>
                                </svg>
                            </button>
                            <div class="flex items-center space-x-2">
                                <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center">
                                    <span id="userInitial" class="text-white text-sm font-medium">U</span>
                                </div>
                                <span id="userName" class="text-sm text-gray-700">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Navigation -->
            <nav class="bg-white border-b border-gray-200">
                <div class="max-w-7xl mx-auto px-4">
                    <div class="flex space-x-8">
                        <button class="nav-item active" data-tab="tickets">–ó–∞—è–≤–∫–∏</button>
                        <button class="nav-item" data-tab="create">–°–æ–∑–¥–∞—Ç—å</button>
                        <button class="nav-item" data-tab="stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                        <button class="nav-item" data-tab="profile">–ü—Ä–æ—Ñ–∏–ª—å</button>
                    </div>
                </div>
            </nav>

            <!-- Content -->
            <main class="max-w-7xl mx-auto px-4 py-6">
                <!-- Tickets Tab -->
                <div id="tickets-tab" class="tab-content">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">–ó–∞—è–≤–∫–∏</h2>
                        <button id="createTicketBtn" class="btn-primary">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>
                    </div>
                    
                    <div class="grid gap-4">
                        <div class="card">
                            <div class="flex justify-between items-start mb-3">
                                <h3 class="text-lg font-medium text-gray-900">–ü–æ–ª–æ–º–∫–∞ –∫–∞—Ä—É—Å–µ–ª–∏ "–í–∏—Ö—Ä—å"</h3>
                                <div class="flex space-x-2">
                                    <span class="badge-new">–ù–æ–≤–∞—è</span>
                                    <span class="badge bg-orange-100 text-orange-800">–í—ã—Å–æ–∫–∏–π</span>
                                </div>
                            </div>
                            <p class="text-gray-600 mb-4">–ö–∞—Ä—É—Å–µ–ª—å –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, —Å–ª—ã—à–µ–Ω —Å–∫—Ä–µ–∂–µ—Ç –≤ –º–µ—Ö–∞–Ω–∏–∑–º–µ</p>
                            <div class="flex items-center justify-between text-sm text-gray-500">
                                <div class="flex items-center space-x-4">
                                    <span>üìç –ö–∞—Ä—É—Å–µ–ª—å "–í–∏—Ö—Ä—å"</span>
                                    <span>üë§ –ù–∞–∑–Ω–∞—á–µ–Ω: –ê–ª–µ–∫—Å–µ–π –°–∏–¥–æ—Ä–æ–≤</span>
                                </div>
                                <span>üïê 2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥</span>
                            </div>
                        </div>

                        <div class="card">
                            <div class="flex justify-between items-start mb-3">
                                <h3 class="text-lg font-medium text-gray-900">–ü—Ä–æ–±–ª–µ–º–∞ —Å –æ—Å–≤–µ—â–µ–Ω–∏–µ–º</h3>
                                <div class="flex space-x-2">
                                    <span class="badge-progress">–í —Ä–∞–±–æ—Ç–µ</span>
                                    <span class="badge bg-blue-100 text-blue-800">–°—Ä–µ–¥–Ω–∏–π</span>
                                </div>
                            </div>
                            <p class="text-gray-600 mb-4">–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Å–≤–µ—â–µ–Ω–∏–µ –Ω–∞ –∞–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏—Ö –≥–æ—Ä–∫–∞—Ö</p>
                            <div class="flex items-center justify-between text-sm text-gray-500">
                                <div class="flex items-center space-x-4">
                                    <span>üìç –ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–µ –≥–æ—Ä–∫–∏</span>
                                    <span>üë§ –ù–∞–∑–Ω–∞—á–µ–Ω: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤</span>
                                </div>
                                <span>üïê 1 —á–∞—Å –Ω–∞–∑–∞–¥</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Create Tab -->
                <div id="create-tab" class="tab-content hidden">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</h2>
                    <div class="card max-w-2xl">
                        <form id="createTicketForm" class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–ó–∞–≥–æ–ª–æ–≤–æ–∫</label>
                                <input type="text" id="title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                                <textarea id="description" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã" required></textarea>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">–°–ª—É–∂–±–∞</label>
                                    <select id="service" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ª—É–∂–±—É</option>
                                        <option value="tech">–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ª—É–∂–±–∞</option>
                                        <option value="security">–°–ª—É–∂–±–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</option>
                                        <option value="cleaning">–°–ª—É–∂–±–∞ —É–±–æ—Ä–∫–∏</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</label>
                                    <select id="priority" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                                        <option value="low">–ù–∏–∑–∫–∏–π</option>
                                        <option value="medium" selected>–°—Ä–µ–¥–Ω–∏–π</option>
                                        <option value="high">–í—ã—Å–æ–∫–∏–π</option>
                                        <option value="critical">–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π</option>
                                    </select>
                                </div>
                            </div>
                            <div class="flex justify-end space-x-4">
                                <button type="button" id="cancelBtn" class="btn-secondary">–û—Ç–º–µ–Ω–∞</button>
                                <button type="submit" class="btn-primary">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Stats Tab -->
                <div id="stats-tab" class="tab-content hidden">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div class="card">
                            <h3 class="text-lg font-medium text-gray-900 mb-4">–û–±—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-600">–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫:</span>
                                    <span class="font-semibold">38</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">–ê–∫—Ç–∏–≤–Ω—ã—Ö:</span>
                                    <span class="font-semibold">16</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è:</span>
                                    <span class="font-semibold">2—á 15–º</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-600">SLA —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è:</span>
                                    <span class="font-semibold text-green-600">85%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Profile Tab -->
                <div id="profile-tab" class="tab-content hidden">
                    <h2 class="text-2xl font-bold text-gray-900 mb-6">–ü—Ä–æ—Ñ–∏–ª—å</h2>
                    <div class="card max-w-2xl">
                        <div class="space-y-6">
                            <div>
                                <h3 class="text-lg font-medium text-gray-900 mb-4">–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">–ò–º—è</label>
                                        <p id="profileName" class="text-gray-900">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">–†–æ–ª—å</label>
                                        <p id="profileRole" class="text-gray-900">–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Telegram WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        let tg = null;
        let currentUser = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            if (window.Telegram && window.Telegram.WebApp) {
                tg = window.Telegram.WebApp;
                tg.ready();
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Ç–µ–º—É
                if (tg.colorScheme === 'dark') {
                    document.documentElement.classList.add('dark');
                }
                
                // –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
                if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                    currentUser = tg.initDataUnsafe.user;
                    updateUserInfo();
                }
                
                console.log('Telegram WebApp initialized');
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('main').classList.remove('hidden');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        function updateUserInfo() {
            if (currentUser) {
                const initial = currentUser.first_name ? currentUser.first_name.charAt(0) : 'U';
                const name = currentUser.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                
                document.getElementById('userInitial').textContent = initial;
                document.getElementById('userName').textContent = name;
                document.getElementById('profileName').textContent = name;
                document.getElementById('profileRole').textContent = '–°–æ—Ç—Ä—É–¥–Ω–∏–∫';
            }
        }

        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ç–∞–±–∞–º
        function showTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ç–∞–±—ã
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active', 'text-blue-600', 'border-blue-500');
                item.classList.add('text-gray-500', 'border-transparent');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π —Ç–∞–±
            document.getElementById(tabName + '-tab').classList.remove('hidden');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            event.target.classList.add('active', 'text-blue-600', 'border-blue-500');
            event.target.classList.remove('text-gray-500', 'border-transparent');
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const tab = this.dataset.tab;
                    showTab(tab);
                });
            });
            
            // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
            document.getElementById('createTicketForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const title = document.getElementById('title').value;
                const description = document.getElementById('description').value;
                const service = document.getElementById('service').value;
                const priority = document.getElementById('priority').value;
                
                // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ backend
                console.log('Creating ticket:', { title, description, service, priority });
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                if (tg && tg.showAlert) {
                    tg.showAlert('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
                } else {
                    alert('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!');
                }
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ —Ç–∞–± –∑–∞—è–≤–æ–∫
                showTab('tickets');
                this.reset();
            });
            
            // –ö–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã
            document.getElementById('cancelBtn').addEventListener('click', function() {
                showTab('tickets');
            });
            
            // –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏
            document.getElementById('createTicketBtn').addEventListener('click', function() {
                showTab('create');
            });
        });

        // –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        const style = document.createElement('style');
        style.textContent = `
            .nav-item {
                @apply py-2 px-1 border-b-2 font-medium text-sm cursor-pointer;
            }
            .nav-item.active {
                @apply text-blue-600 border-blue-500;
            }
            .nav-item:not(.active) {
                @apply text-gray-500 border-transparent hover:text-gray-700 hover:border-gray-300;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
