<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat API Demo - Helpdesk Park</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-3xl font-bold text-center mb-8">üîç Chat API Demo</h1>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">üì° –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Chat API</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Chat ID –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
                        </label>
                        <input type="text" id="chatIdInput" placeholder="-4896951550" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-md">
                        <p class="text-xs text-gray-500 mt-1">
                            –í–≤–µ–¥–∏—Ç–µ ID —á–∞—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                        </p>
                    </div>
                    
                    <div class="flex items-end space-x-2">
                        <button onclick="testChatInfo()" 
                                class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
                            üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ
                        </button>
                        <button onclick="testChatMembers()" 
                                class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700">
                            üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–∞
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-xl font-semibold mb-4">üîß API Endpoints</h2>
                <div class="space-y-2 text-sm">
                    <div class="flex items-center space-x-2">
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs">GET</span>
                        <code class="bg-gray-100 px-2 py-1 rounded">/api/health</code>
                        <span class="text-gray-600">- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">GET</span>
                        <code class="bg-gray-100 px-2 py-1 rounded">/api/chat-info?chat_id=&lt;ID&gt;</code>
                        <span class="text-gray-600">- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">GET</span>
                        <code class="bg-gray-100 px-2 py-1 rounded">/api/chat-members?chat_id=&lt;ID&gt;</code>
                        <span class="text-gray-600">- –£—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–∞</span>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã API</h2>
                <div id="apiResults" class="bg-gray-50 p-4 rounded-md min-h-[200px]">
                    <p class="text-gray-500 text-center">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã API –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3001';
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function showResults(title, data, isError = false) {
            const container = document.getElementById('apiResults');
            const timestamp = new Date().toLocaleTimeString();
            
            const resultHtml = `
                <div class="mb-4 p-3 ${isError ? 'bg-red-50 border-l-4 border-red-400' : 'bg-green-50 border-l-4 border-green-400'}">
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="font-medium ${isError ? 'text-red-800' : 'text-green-800'}">${title}</h4>
                        <span class="text-xs text-gray-500">${timestamp}</span>
                    </div>
                    <pre class="text-sm overflow-x-auto">${JSON.stringify(data, null, 2)}</pre>
                </div>
            `;
            
            container.innerHTML = resultHtml + container.innerHTML;
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —á–∞—Ç–µ
        async function testChatInfo() {
            const chatId = document.getElementById('chatIdInput').value.trim();
            
            if (!chatId) {
                showResults('‚ùå –û—à–∏–±–∫–∞', { error: '–í–≤–µ–¥–∏—Ç–µ Chat ID' }, true);
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/api/chat-info?chat_id=${chatId}`);
                const data = await response.json();
                
                if (response.ok) {
                    showResults(`‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ ${chatId}`, data);
                } else {
                    showResults(`‚ùå –û—à–∏–±–∫–∞ API`, data, true);
                }
            } catch (error) {
                showResults('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏', { error: error.message }, true);
            }
        }
        
        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞
        async function testChatMembers() {
            const chatId = document.getElementById('chatIdInput').value.trim();
            
            if (!chatId) {
                showResults('‚ùå –û—à–∏–±–∫–∞', { error: '–í–≤–µ–¥–∏—Ç–µ Chat ID' }, true);
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/api/chat-members?chat_id=${chatId}`);
                const data = await response.json();
                
                if (response.ok) {
                    showResults(`‚úÖ –£—á–∞—Å—Ç–Ω–∏–∫–∏ —á–∞—Ç–∞ ${chatId}`, data);
                } else {
                    showResults(`‚ùå –û—à–∏–±–∫–∞ API`, data, true);
                }
            } catch (error) {
                showResults('‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏', { error: error.message }, true);
            }
        }
        
        // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ Chat ID
        document.getElementById('chatIdInput').value = '-4896951550';
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ API –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', async () => {
            try {
                const response = await fetch(`${API_BASE}/api/health`);
                const data = await response.json();
                
                if (response.ok) {
                    showResults('‚úÖ –°—Ç–∞—Ç—É—Å API', data);
                } else {
                    showResults('‚ùå –û—à–∏–±–∫–∞ API', data, true);
                }
            } catch (error) {
                showResults('‚ùå API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω', { error: error.message }, true);
            }
        });
    </script>
</body>
</html>
